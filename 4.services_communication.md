flowchart TD
    Users["Global Users (50M)"] --> Route53["Route 53 Global DNS"]
    Route53 --> CDN("CloudFront CDN")
    CDN --> ALB["Application Load Balancer"]
    ALB --> APIGateway["API Gateway"]
    
    subgraph Auth["Authentication Layer"]
        APIGateway --> AuthService["Authentication Service (Cognito)"]
        AuthService --> IAM["Identity & Access Management"]
        AuthService --> SecretsManager["AWS Secrets Manager"]
    end
    
    subgraph ApplicationLayer["Microservices"]
        direction TB
        subgraph ServiceMesh["AWS App Mesh"]
            ImageIngest["Image Ingest Service"]
            SearchService["Search Service"]
            ImageServing["Image Serving Service"]
            IndexingService["Indexing Service"]
            APIService["3rd Party API Service"]
        end
        
        AuthService --> ServiceMesh
    end
    
    subgraph CacheLayer["Caching Layer"]
        ElastiCache["ElastiCache Redis"]
        CloudFrontCache["CloudFront Cache"]
        DAXCache["DynamoDB DAX"]
        
        ImageServing --> ElastiCache
        SearchService --> ElastiCache
        CDN --> CloudFrontCache
    end
    
    subgraph DataStorage["Data Storage Layer"]
        direction TB
        subgraph Primary["Primary Region"]
            S3Primary["S3 (Raw Images)"]
            DDBPrimary["DynamoDB (Metadata)"]
            ESPrimary["OpenSearch (Search Index)"]
        end
        
        subgraph DR["Disaster Recovery Region"]
            S3DR["S3 (Replica)"]
            DDBDR["DynamoDB Global Tables"]
            ESDR["OpenSearch (Replica)"]
        end
        
        ImageIngest --> S3Primary
        IndexingService --> S3Primary
        S3Primary <--> S3DR
        DDBPrimary <--> DDBDR
        ESPrimary <--> ESDR
        
        ImageIngest --> DDBPrimary
        SearchService --> ESPrimary
        ImageServing --> S3Primary
        APIService --> DDBPrimary
    end
    
    subgraph ObservabilityLayer["Observability & Operations"]
        CloudWatch["CloudWatch Monitoring"]
        XRay["X-Ray Tracing"]
        CloudTrail["CloudTrail Audit Logs"]
        Prometheus["Amazon Managed Prometheus"]
        Grafana["Amazon Managed Grafana"]
        
        ServiceMesh --> CloudWatch
        ServiceMesh --> XRay
        ServiceMesh --> Prometheus
        Prometheus --> Grafana
    end
    
    subgraph SecurityLayer["Security Components"]
        Shield["AWS Shield Advanced"]
        WAF["AWS WAF"]
        GuardDuty["Amazon GuardDuty"]
        SecurityHub["AWS Security Hub"]
        Macie["Amazon Macie"]
        
        CDN --> Shield
        ALB --> WAF
        DataStorage --> Macie
        GuardDuty --> SecurityHub
    end
    
    subgraph CostOptimization["Cost Optimization"]
        S3LifeCycle["S3 Lifecycle Policies"]
        AutoScaling["Auto Scaling Groups"]
        S3Intelligence["S3 Intelligence Tiering"]
        
        S3Primary --> S3LifeCycle
        ServiceMesh --> AutoScaling
        S3Primary --> S3Intelligence
    end